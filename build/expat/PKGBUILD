# Maintainer: Christopher Degawa <ccom@randomderp.com>

_realname=expat
pkgbase=mingw-w64-$_realname
pkgname="${MINGW_PACKAGE_PREFIX}-$_realname-git"
pkgver=2.2.9
pkgrel=1
pkgdesc="An XML parser library (mingw-w64)"
arch=('any')
url="https://libexpat.github.io/"
license=(MIT)
makedepends=("${MINGW_PACKAGE_PREFIX}-gcc" "${MINGW_PACKAGE_PREFIX}-pkg-config")
options=('strip' 'staticlibs')
source=("git+https://github.com/libexpat/libexpat.git")
sha256sums=('SKIP')

prepare() {
  autoreconf -fiv "$srcdir/$_realname"
}

build() {
  rm -rf "$srcdir/build-$MINGW_CHOST"
  mkdir -p "$srcdir/build-$MINGW_CHOST"
  cd "$srcdir/build-$MINGW_CHOST" || exit

  ../$_realname/configure \
    --prefix="$LOCALDESTDIR" \
    --build="$MINGW_CHOST" \
    --host="$MINGW_CHOST" \
    --target="$MINGW_CHOST" \
    --disable-shared \
    --enable-static
  make
}

package() {
  cd "$srcdir/build-$MINGW_CHOST"
  make DESTDIR="$pkgdir" install
  install -Dm644 "$srcdir/$_realname/COPYING" "$pkgdir$LOCALDESTDIR/share/licenses/$_realname/COPYING"
}